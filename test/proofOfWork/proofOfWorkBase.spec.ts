/**
 * Tests for ProofOfWorkBase.
 */
import { ITimeService } from "@iota-pico/core/dist/interfaces/ITimeService";
import { Hash } from "@iota-pico/data/dist/data/hash";
import { Trytes } from "@iota-pico/data/dist/data/trytes";
import * as chai from "chai";
import * as sinon from "sinon";
import { ProofOfWorkBase } from "../../src/proofOfWork/proofOfWorkBase";

class ProofOfWorkTest extends ProofOfWorkBase {
    public async singlePow(trytes: Trytes, minWeightMagnitude: number): Promise<Trytes> {
        return Trytes.fromString("9".repeat(2673));
    }
}

describe("ProofOfWorkBase", () => {
    let sandbox: sinon.SinonSandbox;

    beforeEach(() => {
        sandbox = sinon.sandbox.create();
    });

    afterEach(() => {
        sandbox.restore();
    });

    it("can be created", () => {
        const obj = new ProofOfWorkTest();
        chai.should().exist(obj);
    });

    describe("initialize", async () => {
        it("can be called", async () => {
            const obj = new ProofOfWorkTest();
            await obj.initialize();
            chai.should().exist(obj);
        });
    });

    describe("pow", async () => {
        it("can fail with no trunkTransaction", async () => {
            const obj = new ProofOfWorkTest();
            try {
                await obj.pow(undefined, undefined, undefined, undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("trunkTransaction");
            }
        });

        it("can fail with no branchTransaction", async () => {
            const obj = new ProofOfWorkTest();
            try {
                await obj.pow(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), undefined, undefined, undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("branchTransaction");
            }
        });

        it("can fail with no trytes", async () => {
            const obj = new ProofOfWorkTest();
            try {
                await obj.pow(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), Hash.fromTrytes(Trytes.fromString("B".repeat(81))), undefined, undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("trytes");
            }
        });

        it("can fail with no minWeightMagnitude", async () => {
            const obj = new ProofOfWorkTest();

            const trinaryString = Trytes.fromString("A".repeat(2673));
            try {
                await obj.pow(Hash.fromTrytes(Trytes.fromString("A".repeat(81))), Hash.fromTrytes(Trytes.fromString("B".repeat(81))), [ trinaryString ], undefined);
            } catch (err) {
                chai.expect(err.message).to.contain("minWeightMagnitude");
            }
        });

        it("can fail with wrong bundle order", async () => {
            const timeServiceStub = <ITimeService>{};
            timeServiceStub.msSinceEpoch = sandbox.stub().returns(1518782585);

            // tslint:disable:max-line-length
            const trytes = [
                Trytes.fromString("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999JFYYRIS9WRJDC9JPOJVEJION9ESLZYQYBQMDBFTJVWQKAQA9BAWSCBTZCEZHVKWUK9GRFWGEOKYL99ROWA99999999999999999999999999NPTAECO99999999999999999999RPEUYYD99999999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDVOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999FIKWZXHJE999999999MMMMMMMMMRA9999GB9999999999999999999"),
                Trytes.fromString("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXOB9999999999999999999999999IOTAECO99999999999999999999TPEUYYD99C99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDOIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999SVUWYDHJPTC9XMHAUKSGKSPRCUDMLVIKPHODOWRRVIHBTSTKVJSC9UQAEZRBAHHIFNAEOCDKDEBH99999IOTAECO99999999999999999999KKWBYXHJE999999999MMMMMMMMMWZ999IC99999999999999999999"),
                Trytes.fromString("UXOSOIOPQ9QGALOORPGZOFOJOZ9EMSFKGUUJG9SA9ATSJELEQXHEPCVFDFEHYDOGQQDT9XHISQWLPMTV99LTRGGLVE9ZFFXXNNHUPNWU9EC9MXO9STXBKSLVNDAZKLMNQRW9ZTYUY9WEVMVABWLSTWEZEBDTYKC9ZCUICHPYLTYPHTQF9HZBIUMLGOELFTY9PTQZQMKUUDPWJCPZAQMTWINNGTXDWYMJTPGQRU9UZ9DQFLDSNWXAGVV9ABTSMVTQSKZBFGIFDDQTLKXBGODJVAFHBGNDVOBLJHMLILKL9OMGAYTHEBEPASBRMLJ9DJVVMEGAFYQYXLXDORHLLYCMWBNJERVGYQZRVJZGDPKCURWPMYUSZEEHOTAPXBGZCLDGCITYDFIEVGSFGPQCQHKFAYAWRKKP9ZCUJCXGA9SJBI9JWBTXTSABRHNHCNVOGOTKUVUZNQNCMHAGPTCPTAONJIVEINCF9SWYJKPVOXCQIBCMHJEWP9QJLUHJJMAZEISCSMETAWLWAYUQBZS9JBNTKAM9WTBKLVXZDZPTSUTLQ9ALZLENK9PMKBXILU9PAXINFXWFYYALAROZVAIGUNCZHYFZVMPTPOWIIWMGDNVQRLDPMROITDYHEFTAGUNMPHEXSJWYKVMZYDFWJJDOBHX9YSMLUBESHYJTEOVXMPMLUKESCBXLCFLEESEATRDATXSBTFDGMKVC9FPEBGTHDXUTODVZWYDKGKAMVNFHZPMU9JYUAAGNKDQWUOZ9IOTORVLVXCSEOAGNEIAXXQHKFUSEYLTUPXYYQEL9SDCZVVUYPBAJBFQOXWRPWGQDLTQKTDNTQWHAJDM9JVFAKBXB9MWENGM9JXSWAPWFHOQAPZIJXVNGZZMVQSSRZLOFMOXNFROU9IFGZSPUTTOVNPMXLNX9YFFFVOKBBSQVRZSVFEGMYJRZSTCOCQZFINODQKOSFWNDUQRYIBKCCELAEIRZZJRIFDXMTHKYCVPMBWWYSRFRPPIKM9VOYKGPCNDBSFALKLNLVOPBQAVPETSFNOGEZHQRQGRJSUTXZGYYAQHBCTEMBKH9BMGJICLAIGWICSTAWC9EDIRLKNRX9CUTPHRF9JLOTW9YTGVQBIKZBCXMHDMSREHQTZHOZCGJRNXLCBPJRURUQJNBETEQKWUXZXGJUSMDDN9LKPKLJIRFDKYUCRXWCQCOPCSKYOTSS99BDWSWZAW9GNY9NJABZOVFZLTXGZBOOCSDNLZ9NPFEUBIRQLNGPVAKOULOMCRUGGTAXFKSUEG9JPBGKMHG9IBVMVYDSWWG9PGCYPGONWNSJZNIXRXCMLHIVXGYKKKFSKVFYPVVZFANXWAXSMJSJAHECOCACADMOLUG9TNNOKLDZVXDJOIHAOZFXBL9TBZWWNCZWAFLXLSF99SCPNSXJNPDLEGK9POVCNBXGCMOKB9FKECOETSPQZOTPGWYZYH9TMGFBNYRSWHBFUCLWLNMHTMXMVDXKFAFKLPDXTURFMWZYDGXU9PFVXIUM9XB9NXTVSZFYPSDHHNYWGANGOXLQNOMZBZSQMZPFMCICRETIHVIFXBNNZW9CUZGJRJBFVEAWOIPLUCSDBKGDB99HZJOYYPBIZFPLLZDTQJHDEZUGNBP9EG9TBPXROUEYKUJTCFVBMUQSRPEBZLSWRKOJOXXIJDRJJECUXMOPVB9P9VRGPDHATDLAXRCOTZRPUGWQQYOV9AKSZFUUBHRJZIIRBHOK9VOCJKHUXSHAEYKZYTDRDG9GREIJTJCSBHSDTHVZLYQHCMSX9TAROFTHXAGZY9AJXIGSUTKXUWHLZOZRYR9QP9MSJYNDJJVRW9MPYSCRVYLWYGFILDSLIGBOOGXDQCRPMFMDYVVPGRXNBXTVSNLXXIIZN9SQOJWLHZTWSOJHBSZOAISYBYSJDORWAHISFAKQFELOPTUEOFRVBCYAFHGDWIEMYAJQFHHDNLWUAQTHUQ9MPLJRIVXHRCNPICWE99RMJSZPJJSZRDQWLTOZFHCHNTCMRSNCEIZ9UGUZPQEEZQVWI9PFOQBSXBEILJUWKKIFIAZRYFNSXYCFCFHSECXOPRI9WRLJTXTNMZNMKJQBHPUQJK9PXFZTFQGRVCFLLHRMDSQNROHWMGCJXNHRHXIKZMAJOMQDGQNHLVUYKRYCUDIYAHZQKIKSHCDWJZPJTMLCACGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999IOTAECO99999999999999999999RPEUYYD99B99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDAWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999SLFBYXHJE999999999MMMMMMMMMUA9999CD9999999999999999999"),
                Trytes.fromString("YEBIXEFVI9EAFGCQVXHHSAPAOGIYHU9MYGHGKZCSMNYQEFJVHVTHCSEFGWOVBV9WFSWIMWJUSJEBNGOKY9CBFZOXORPQFEVMLPTDXLTBJKBWBYYFCZMZQDDVELFRGBXH9LPFGWKJABFESWDKKDMTYUDGLGUWEKITZZBZ9NCOZAHHEFRIQ9LNCXTRWTFCKAUGUTVDDDPIKFQULMELMDPTGCYEROOTAHCGAFGDKBBYYFFNFAJNBZWHSXZSKFZYCHXAEKYUUWCDSRSWHPZPBBMOSLQNEKAVXVFUBTUJHHOCXUDCCWZQIBXAYOGCNRMWOTBEHFZBZ9MBYYIMMAMUYTXT9RBUWMO9MZ9GWOMKRDCJZXZDCQFASPPO9JLLCJITFPHRTFNCPYRQVLVGKIGHUHVJAEJUVLWTFUXHVSGVSRHSFJZJDXIKMFYUMOKZOEONTXTJZSN9FPGUQG9KUDVPEFVSJHERINWVIEEHW9HFSBGFUOLTUAMHGVKFAAVOV99BZFFECJJLUUBMNWZXXALHFCZ9BYIJVRSZRYHFEOCBXSMMFOBEALFSJVDBFZXPYADWUNQWNBXUYWSBHPZMWN9CLPWWNTKPUYWGWVVMJIFREIOYBGRCBLYRJ9PJNBMZJZUFHKXCPUTWBPVAVLTCUAY9XWEFXROHFVKJQELDCNRUJKMTFOOIFMLPVZ9NHQJGTPAIXTJBZTJMEYFCJBB9IXXHKKWKLOXIWELMNQZC9VHXFVTTTNRVDI9FRDBJVG9FETTMLZTZGWZFOLZUTS9ZCXOJPEUUMTGBVMVKXZFERMPXRROMGCBUJMQBCNMESYXAVTZWMWRGURJZCKFHLTHCRZ9EHJYVAVRJTCGKYY9YYJSXLLJNBINADXJIEQDAYVJCHMCMJUXW9CEABAWXDTNMUPEQFFDAKDGLEBJFJTOHKFSWSIAEEDNFSYRQQAIPMWWUINHTNNIMLGGUCBOHAPACUKSA9ATZRRJX9EKPB9AFSZAWKVMTUSHKHUBTYZHIUBRJUSCVHFODQXMTWVJUIOUVASGUGGAGISOVIBTIBNUXTXGCWRAP99LATODRQOHTLAOGELRCESWWIWQPUBRUTWDWMLNMCDVAEOGSAVQHJATGWPWGODRLIOTVBYMGFUZP9PZKUJNGGSIRNMVQKPGWCIMYBFLJIUKT9TAFJ9ZFTBWBQTBUG9LDPYETFOKQARREPXSKLGU9S9CTERNNILBZI9XRVKFHXCDNUTWEUOCJZX9LDETPXFAHOWIGVWTGBRPLXA9XY9INGSIIRSNFWVPEQAWNTGA9RQTBLITJJFETDVTEWDIMONVKTBLSXMSKKYBILUNTBEL9WGUOSCRMQSGMNMWWANPNLFL9WSMTZOZKOPGDAGUBGKJZZJGGEXPIGPLZMMIRSUL9TQMLJIWNVLXBIUGPAMWETCPYSJDNPSQQQVGMYZJ9WVBXSGIVEIXNLZVFOSWVEAVILGAEFMLFAZUTREYXRLMGQXGZNRYCIIVNAKJBTXNWKKNHONB9HRDRWZXUBFLBLBFLPRUPESYRFIWOBHSOHNZRPTTUZQVHJGLDQFIGCYFXZNLQIBHFZEJVILLXNVDNJTENZPCEJJCANBQTJFHOXFUJOGZWPOYPDOYEUD9GMBAPIUEWRUANPKBSRXWMEHZOIFITOFSWQPMHERKYEJN9ICFSCGWCWPMSKBSUSKQVLUAGWVXDTOQLRBUNKOXBGXCRYJIHPTEXNTULUIYWKKENAZHDISMTCLGRA9UOJRABDALGHUBQPTIVZSINV9POB9QDXWJFFYSMUFNNPSGBVFTUTXEKEVHGRHAGQDXTOVLOSRNMSZGAOCDJLUBKLO9LOVRNMCKAGPQWTYZSLUZUZLOXJUFDWYVVRX9ZQSQSNERAMUPEPQFVMWKFSACJVHLDUWRHUXKPVEYEBGEBZVIBLFSCCLCHFGNXMGEAOKSOHI9GWIMDVHXYKQKQJAUG9JSKYCE9VJGKMUDRRHTOMDDIKQTJPSPWNLNWRPPMXGFOMTTF9KNJFWQCDSBGHDIUWNJO9IUN9RPIVRYXBPZ9ZGT9PBSLHRKYRJVSYIXMBBDIRWBIISXFYSGCXYRGJSCJUCVGCPLORC9EB9ODBKJABDUAVCMLHZGUNHJIAVFOFFAFNJCAIFSE9IJLZDPXQEFZHFYEJVCCCSM9CYKTS9SGXFYFQWWGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999IOTAECO99999999999999999999RPEUYYD99A99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDFDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999IUVLYXHJE999999999MMMMMMMMMLA999IAE9999999999999999999")
            ];

            const trunkTransaction = Hash.fromTrytes(Trytes.fromString("YQGAYYJKDZTJCBPWPLJMHQYSCSYFVMJAPGAKXV9MANHTZTJDRDQLCVCOLPJEYUWXUHAZPHIXFYVPA9999"));
            const branchTransaction = Hash.fromTrytes(Trytes.fromString("JIZKAGFRQSMSNNBUKZK9IYSLTSBWAREBLVMWWIDGKY9AJSCCJPPQTXFPNPMACCOH9ANMSUFHRY9J99999"));

            try {
                const obj = new ProofOfWorkTest();
                await obj.pow(trunkTransaction, branchTransaction, trytes, 1);
            } catch (err) {
                chai.expect(err.message).to.contain("Wrong bundle order");
            }
        });

        it("can complete", async () => {
            const timeServiceStub = <ITimeService>{};
            timeServiceStub.msSinceEpoch = sandbox.stub().returns(1518782585);

            // tslint:disable:max-line-length
            const trytes = [
                Trytes.fromString("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999PSTBGFZXBMTWL9JMOCPTJWO9GUDMJYMUJZ9IHLANBIEXVOWD9THLDYKE9JDIGKMPKGPOTOXPCNSDZKVGXOB9999999999999999999999999IOTAECO99999999999999999999TPEUYYD99C99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDOIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999SVUWYDHJPTC9XMHAUKSGKSPRCUDMLVIKPHODOWRRVIHBTSTKVJSC9UQAEZRBAHHIFNAEOCDKDEBH99999IOTAECO99999999999999999999KKWBYXHJE999999999MMMMMMMMMWZ999IC99999999999999999999"),
                Trytes.fromString("999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999999JFYYRIS9WRJDC9JPOJVEJION9ESLZYQYBQMDBFTJVWQKAQA9BAWSCBTZCEZHVKWUK9GRFWGEOKYL99ROWA99999999999999999999999999NPTAECO99999999999999999999RPEUYYD99999999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDVOLJEUPN9ZXTCZD9OTOZFJVYTJVRZIKEIYWGUHVLJLUL9BZUPLQNYLEKYIGCJRHT9SCKJLRZNDTY99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999FIKWZXHJE999999999MMMMMMMMMRA9999GB9999999999999999999"),
                Trytes.fromString("UXOSOIOPQ9QGALOORPGZOFOJOZ9EMSFKGUUJG9SA9ATSJELEQXHEPCVFDFEHYDOGQQDT9XHISQWLPMTV99LTRGGLVE9ZFFXXNNHUPNWU9EC9MXO9STXBKSLVNDAZKLMNQRW9ZTYUY9WEVMVABWLSTWEZEBDTYKC9ZCUICHPYLTYPHTQF9HZBIUMLGOELFTY9PTQZQMKUUDPWJCPZAQMTWINNGTXDWYMJTPGQRU9UZ9DQFLDSNWXAGVV9ABTSMVTQSKZBFGIFDDQTLKXBGODJVAFHBGNDVOBLJHMLILKL9OMGAYTHEBEPASBRMLJ9DJVVMEGAFYQYXLXDORHLLYCMWBNJERVGYQZRVJZGDPKCURWPMYUSZEEHOTAPXBGZCLDGCITYDFIEVGSFGPQCQHKFAYAWRKKP9ZCUJCXGA9SJBI9JWBTXTSABRHNHCNVOGOTKUVUZNQNCMHAGPTCPTAONJIVEINCF9SWYJKPVOXCQIBCMHJEWP9QJLUHJJMAZEISCSMETAWLWAYUQBZS9JBNTKAM9WTBKLVXZDZPTSUTLQ9ALZLENK9PMKBXILU9PAXINFXWFYYALAROZVAIGUNCZHYFZVMPTPOWIIWMGDNVQRLDPMROITDYHEFTAGUNMPHEXSJWYKVMZYDFWJJDOBHX9YSMLUBESHYJTEOVXMPMLUKESCBXLCFLEESEATRDATXSBTFDGMKVC9FPEBGTHDXUTODVZWYDKGKAMVNFHZPMU9JYUAAGNKDQWUOZ9IOTORVLVXCSEOAGNEIAXXQHKFUSEYLTUPXYYQEL9SDCZVVUYPBAJBFQOXWRPWGQDLTQKTDNTQWHAJDM9JVFAKBXB9MWENGM9JXSWAPWFHOQAPZIJXVNGZZMVQSSRZLOFMOXNFROU9IFGZSPUTTOVNPMXLNX9YFFFVOKBBSQVRZSVFEGMYJRZSTCOCQZFINODQKOSFWNDUQRYIBKCCELAEIRZZJRIFDXMTHKYCVPMBWWYSRFRPPIKM9VOYKGPCNDBSFALKLNLVOPBQAVPETSFNOGEZHQRQGRJSUTXZGYYAQHBCTEMBKH9BMGJICLAIGWICSTAWC9EDIRLKNRX9CUTPHRF9JLOTW9YTGVQBIKZBCXMHDMSREHQTZHOZCGJRNXLCBPJRURUQJNBETEQKWUXZXGJUSMDDN9LKPKLJIRFDKYUCRXWCQCOPCSKYOTSS99BDWSWZAW9GNY9NJABZOVFZLTXGZBOOCSDNLZ9NPFEUBIRQLNGPVAKOULOMCRUGGTAXFKSUEG9JPBGKMHG9IBVMVYDSWWG9PGCYPGONWNSJZNIXRXCMLHIVXGYKKKFSKVFYPVVZFANXWAXSMJSJAHECOCACADMOLUG9TNNOKLDZVXDJOIHAOZFXBL9TBZWWNCZWAFLXLSF99SCPNSXJNPDLEGK9POVCNBXGCMOKB9FKECOETSPQZOTPGWYZYH9TMGFBNYRSWHBFUCLWLNMHTMXMVDXKFAFKLPDXTURFMWZYDGXU9PFVXIUM9XB9NXTVSZFYPSDHHNYWGANGOXLQNOMZBZSQMZPFMCICRETIHVIFXBNNZW9CUZGJRJBFVEAWOIPLUCSDBKGDB99HZJOYYPBIZFPLLZDTQJHDEZUGNBP9EG9TBPXROUEYKUJTCFVBMUQSRPEBZLSWRKOJOXXIJDRJJECUXMOPVB9P9VRGPDHATDLAXRCOTZRPUGWQQYOV9AKSZFUUBHRJZIIRBHOK9VOCJKHUXSHAEYKZYTDRDG9GREIJTJCSBHSDTHVZLYQHCMSX9TAROFTHXAGZY9AJXIGSUTKXUWHLZOZRYR9QP9MSJYNDJJVRW9MPYSCRVYLWYGFILDSLIGBOOGXDQCRPMFMDYVVPGRXNBXTVSNLXXIIZN9SQOJWLHZTWSOJHBSZOAISYBYSJDORWAHISFAKQFELOPTUEOFRVBCYAFHGDWIEMYAJQFHHDNLWUAQTHUQ9MPLJRIVXHRCNPICWE99RMJSZPJJSZRDQWLTOZFHCHNTCMRSNCEIZ9UGUZPQEEZQVWI9PFOQBSXBEILJUWKKIFIAZRYFNSXYCFCFHSECXOPRI9WRLJTXTNMZNMKJQBHPUQJK9PXFZTFQGRVCFLLHRMDSQNROHWMGCJXNHRHXIKZMAJOMQDGQNHLVUYKRYCUDIYAHZQKIKSHCDWJZPJTMLCACGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICD999999999999999999999999999IOTAECO99999999999999999999RPEUYYD99B99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDAWRHURPMPYMTYTXSVZRPBBNWYKHQRTICMMUFEJ9UW9NUIAOGWWWCRHLTESZUPHOEWHVVGAMI9HQU99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999SLFBYXHJE999999999MMMMMMMMMUA9999CD9999999999999999999"),
                Trytes.fromString("YEBIXEFVI9EAFGCQVXHHSAPAOGIYHU9MYGHGKZCSMNYQEFJVHVTHCSEFGWOVBV9WFSWIMWJUSJEBNGOKY9CBFZOXORPQFEVMLPTDXLTBJKBWBYYFCZMZQDDVELFRGBXH9LPFGWKJABFESWDKKDMTYUDGLGUWEKITZZBZ9NCOZAHHEFRIQ9LNCXTRWTFCKAUGUTVDDDPIKFQULMELMDPTGCYEROOTAHCGAFGDKBBYYFFNFAJNBZWHSXZSKFZYCHXAEKYUUWCDSRSWHPZPBBMOSLQNEKAVXVFUBTUJHHOCXUDCCWZQIBXAYOGCNRMWOTBEHFZBZ9MBYYIMMAMUYTXT9RBUWMO9MZ9GWOMKRDCJZXZDCQFASPPO9JLLCJITFPHRTFNCPYRQVLVGKIGHUHVJAEJUVLWTFUXHVSGVSRHSFJZJDXIKMFYUMOKZOEONTXTJZSN9FPGUQG9KUDVPEFVSJHERINWVIEEHW9HFSBGFUOLTUAMHGVKFAAVOV99BZFFECJJLUUBMNWZXXALHFCZ9BYIJVRSZRYHFEOCBXSMMFOBEALFSJVDBFZXPYADWUNQWNBXUYWSBHPZMWN9CLPWWNTKPUYWGWVVMJIFREIOYBGRCBLYRJ9PJNBMZJZUFHKXCPUTWBPVAVLTCUAY9XWEFXROHFVKJQELDCNRUJKMTFOOIFMLPVZ9NHQJGTPAIXTJBZTJMEYFCJBB9IXXHKKWKLOXIWELMNQZC9VHXFVTTTNRVDI9FRDBJVG9FETTMLZTZGWZFOLZUTS9ZCXOJPEUUMTGBVMVKXZFERMPXRROMGCBUJMQBCNMESYXAVTZWMWRGURJZCKFHLTHCRZ9EHJYVAVRJTCGKYY9YYJSXLLJNBINADXJIEQDAYVJCHMCMJUXW9CEABAWXDTNMUPEQFFDAKDGLEBJFJTOHKFSWSIAEEDNFSYRQQAIPMWWUINHTNNIMLGGUCBOHAPACUKSA9ATZRRJX9EKPB9AFSZAWKVMTUSHKHUBTYZHIUBRJUSCVHFODQXMTWVJUIOUVASGUGGAGISOVIBTIBNUXTXGCWRAP99LATODRQOHTLAOGELRCESWWIWQPUBRUTWDWMLNMCDVAEOGSAVQHJATGWPWGODRLIOTVBYMGFUZP9PZKUJNGGSIRNMVQKPGWCIMYBFLJIUKT9TAFJ9ZFTBWBQTBUG9LDPYETFOKQARREPXSKLGU9S9CTERNNILBZI9XRVKFHXCDNUTWEUOCJZX9LDETPXFAHOWIGVWTGBRPLXA9XY9INGSIIRSNFWVPEQAWNTGA9RQTBLITJJFETDVTEWDIMONVKTBLSXMSKKYBILUNTBEL9WGUOSCRMQSGMNMWWANPNLFL9WSMTZOZKOPGDAGUBGKJZZJGGEXPIGPLZMMIRSUL9TQMLJIWNVLXBIUGPAMWETCPYSJDNPSQQQVGMYZJ9WVBXSGIVEIXNLZVFOSWVEAVILGAEFMLFAZUTREYXRLMGQXGZNRYCIIVNAKJBTXNWKKNHONB9HRDRWZXUBFLBLBFLPRUPESYRFIWOBHSOHNZRPTTUZQVHJGLDQFIGCYFXZNLQIBHFZEJVILLXNVDNJTENZPCEJJCANBQTJFHOXFUJOGZWPOYPDOYEUD9GMBAPIUEWRUANPKBSRXWMEHZOIFITOFSWQPMHERKYEJN9ICFSCGWCWPMSKBSUSKQVLUAGWVXDTOQLRBUNKOXBGXCRYJIHPTEXNTULUIYWKKENAZHDISMTCLGRA9UOJRABDALGHUBQPTIVZSINV9POB9QDXWJFFYSMUFNNPSGBVFTUTXEKEVHGRHAGQDXTOVLOSRNMSZGAOCDJLUBKLO9LOVRNMCKAGPQWTYZSLUZUZLOXJUFDWYVVRX9ZQSQSNERAMUPEPQFVMWKFSACJVHLDUWRHUXKPVEYEBGEBZVIBLFSCCLCHFGNXMGEAOKSOHI9GWIMDVHXYKQKQJAUG9JSKYCE9VJGKMUDRRHTOMDDIKQTJPSPWNLNWRPPMXGFOMTTF9KNJFWQCDSBGHDIUWNJO9IUN9RPIVRYXBPZ9ZGT9PBSLHRKYRJVSYIXMBBDIRWBIISXFYSGCXYRGJSCJUCVGCPLORC9EB9ODBKJABDUAVCMLHZGUNHJIAVFOFFAFNJCAIFSE9IJLZDPXQEFZHFYEJVCCCSM9CYKTS9SGXFYFQWWGGOUIA9VBWFTAUGFMEYYGYMOVBGT9XKBELVEFVWNKTRIUYGGWPTBJNSKOBNJGAXRGHHAZXBXZKLHTPICDKY9999999999999999999999999IOTAECO99999999999999999999RPEUYYD99A99999999C99999999ZKSRLSYWCTGACGBO9KUSKHRFNTFHHNPBODSHJZOIBTDVJXYJQRCJHVUABCDGG9TKGIGBTRZGRCS9JIKUDFDPHO9BUJWIEAMNNVPJQXIUNZEOKASNBNDP9CZNHZOVXGKOJ9KZNM9PEHVXOVHVNPKNUDLYTVHQX99999OIGRZZGWHAGCONBXN9GWMDSANUHXGAYLFYKTMBK9CRAYWLZKTRCQKTPBTMWL9XMKEU9IQZN9LL9SA9999IOTAECO99999999999999999999IUVLYXHJE999999999MMMMMMMMMLA999IAE9999999999999999999")
            ];

            const trunkTransaction = Hash.fromTrytes(Trytes.fromString("YQGAYYJKDZTJCBPWPLJMHQYSCSYFVMJAPGAKXV9MANHTZTJDRDQLCVCOLPJEYUWXUHAZPHIXFYVPA9999"));
            const branchTransaction = Hash.fromTrytes(Trytes.fromString("JIZKAGFRQSMSNNBUKZK9IYSLTSBWAREBLVMWWIDGKY9AJSCCJPPQTXFPNPMACCOH9ANMSUFHRY9J99999"));

            const obj = new ProofOfWorkTest();
            const res = await obj.pow(trunkTransaction, branchTransaction, trytes, 1);
            chai.expect(res.length).to.be.equal(4);
        });
    });
});
